Session summary (initializer)
- Generated feature_list.json with 400 unique tests (30 have >=10 steps; categories functional+style; all passes=false).
- Added init.sh to install dependencies via uv/npm, optional Airflow bootstrap, optional dev server startup.
- Updated README with project overview, stack, and quick start instructions.
- No code implementation yet; Python deps not added beyond pyproject template.
- Next: add actual backend/frontend code, populate pyproject dependencies with uv add, wire Rust extractor, and begin marking tests as they pass.

Session 2026-01-24 (backend + UI scaffold)
- Targeted feature 001: added backend pipeline skeleton (config, DuckDB schema, Lichess fetcher, PGN position extractor, Stockfish wrapper with deterministic options, tactics analyzer, pipeline runner, FastAPI API, Airflow DAG stub).
- Scaffolded React/Vite/Tailwind dashboard with cache-busting indicator and buttons to trigger sync via API.
- Updated pyproject for Python 3.12 stack and added Airflow/analytics dependencies; Python 3.12 not yet installed locally, uv sync pending.
- Outstanding: install Python 3.12 + recreate venv, run uv sync, wire real Stockfish 17 binary with checksum, add robust motif detection and tests (unit/integration/puppeteer), run Airflow DAG end-to-end, capture screenshots, and flip feature 001 after verification.

Session 2026-01-24 (feature 001 end-to-end verification)
- Installed Python 3.12 venv, synced dependencies, and ran full pytest suite (11 passing) covering checkpoints, extractor, Stockfish determinism, Airflow DAG load, and pipeline/metrics writing.
- Reset checkpoint and ran `run_daily_game_sync` using fixture PGNs; DuckDB now holds raw_pgns=2, positions=48, tactics=48, outcomes=48 with metrics_version=10.
- Defaulted Stockfish config to PATH (`stockfish`) while allowing env override; analysis still deterministic.
- Rebuilt frontend with `VITE_API_BASE=http://localhost:8000`, axios honors env base, and Puppeteer script now starts/stops FastAPI + preview automatically; captured dashboard screenshot at `verification/feature001-dashboard.png`.
- Feature 001 verified through UI (pipeline trigger, metrics refresh, dashboard data), passes=true in feature_list.json.

Session 2026-01-24 (feature 002 – Chess.com blitz pipeline)
- Added Chess.com client + shared PGN utilities; settings/pipeline/API now source-aware with metrics grouped by source.
- Frontend dashboard includes source toggle; puppeteer script selects Chess.com and captures `verification/dashboard-chesscom.png`.
- Added chesscom fixtures and tests (client + pipeline state + integration); DuckDB metrics_summary migrated with source column.
- Ran full pytest (14 passed), rebuilt frontend with `VITE_API_BASE=http://localhost:8000`, executed chesscom pipeline to `data/tactix_chesscom.duckdb` (raw_pgns=2, positions=12, tactics=12, metrics_version=1).
- Marked feature 002 passes=true after UI verification.

Session 2026-01-24 (feature 003 – Lichess incremental since)
- Pipeline now short-circuits when no new Lichess games and returns checkpoint metadata; Airflow DAG start_date is timezone-aware and logs execution_date in task output.
- Added incremental regression tests (pipeline double-run skip + metrics bump) and scheduler logical_date/interval check; full pytest now 16/16.
- Reset checkpoints and ran pipeline twice on fixtures: first run ingested 2 games (positions=16, tactics=16, metrics_version=1, checkpoint=1717335000000); second run fetched 0 and left counts unchanged while bumping metrics_version to 2.
- Puppeteer Run+Refresh captured `verification/dashboard-lichess-since.png`; Lichess metrics_version at 3 after UI verification.

Session 2026-01-24 (feature 004 – Chess.com cursor incremental)
- Implemented cursor-based Chess.com incremental fetch with cursor persistence and raw_pgns cursor metadata; pipeline returns cursor/last_ts and writes cursor checkpoints.
- DuckDB schema now includes cursor column; added Chess.com client + pipeline regression tests for cursor skip and metrics_version bump on no-op runs (pytest modules all passing).
- Verified incremental behavior on fresh cursor path: run1 fetched 2 games (positions=12, tactics=12), run2 skipped with cursor unchanged; metrics_version incremented.
- Puppeteer UI (source=chesscom) triggered pipeline and captured `verification/dashboard-chesscom-cursor.png`; feature_list.json 004 marked passes=true.

Session 2026-01-24 (feature 005 – Lichess resume mid-fetch)
- Added retrying Lichess fetch with tenacity, per-game cleanup before reinserts, and deferred checkpoint/cursor writes until successful completion.
- New DuckDB cleanup helper for retries and Airflow exponential backoff defaults on daily_game_sync tasks.
- Regression tests cover analyze failure resume and fetch failure checkpoint; full pytest (19) passing.
- Simulated mid-run failure: first run left raw_pgns=2/positions=16/tactics=0, rerun produced tactics=16/outcomes=16 with checkpoint=1717335000000 and metrics_version=1.
- Puppeteer dashboard verification captured `verification/dashboard-lichess-resume.png`; feature 005 set to passes=true.

Session 2026-01-27 (regression fix – recent positions/tactics filters)
- Fixed recent positions/tactics date filtering to normalize datetime inputs to dates before comparing against created_at.
- Targeted pytest passed; make check completed (pytest + coverage + vitest).

Session 2026-01-27 (regression fixes – features 001 + 003)
- Feature 003: updated Airflow log Puppeteer script to target the correct task id (`run_lichess_pipeline` by default) to avoid 404 log resource errors.
- Re-ran UI verification scripts: feature 001 and feature 003 passed with no console errors.
- Regression verification for feature 002 completed; screenshot: `verification/feature-002-ui-2026-01-27.png`.
- New screenshots: `verification/feature-001-ui-2026-01-27.png`, `verification/feature-003-airflow-log-2026-01-27.png`.
- Tests: `node verification/puppeteer_regression_feature_001.js`, `node verification/puppeteer_airflow_lichess_incremental_log.js`.
- Feature pass count: 118.

Session 2026-01-28 (feature 119 – Postgres raw PGN storage)
- UI: ensure `[data-testid="postgres-raw-pgns"]` renders even on error by showing the card with an inline error.
- Services: `docker compose -f compose.yml ps` confirmed server/client/postgres/airflow running.
- API checks: `curl -H 'Authorization: Bearer local-dev-token' http://localhost:8000/api/postgres/status | jq .` and `/api/postgres/raw_pgns`.
- Ingestion check: `node verification/integration_feature_119_postgres_raw_pgns.js` (triggered daily sync when empty).
- DB validation: `\d tactix_pgns.raw_pgns` shows metadata columns + indexes; sample rows + normalization lengths verified; duplicate check `count(*) vs count(distinct game_id||':'||source)` matched.
- UI verification: `node verification/puppeteer_feature_119_postgres_raw_pgns.js` → `verification/feature-119-postgres-raw-pgns-2026-01-28.png`.
- Tests: `make check` (all checks + pytest + vitest passed; Rust warnings only).
- Feature pass count: 119.

Session 2026-01-27 (feature 120 – Postgres interfaces across Rust/Python/TS)
- Rust: added `tokio-postgres` smoke test (`cargo run --bin postgres_smoke`) and verified CRUD with env `TACTIX_POSTGRES_*` (output: "Rust CRUD ok").
- Python: verified psycopg2 usage via `verification/postgres_smoke.py` using `postgres_store.postgres_connection` (output: "Python CRUD ok").
- TypeScript: added `pg` + `tsx` and ran `npm run pg:smoke` (output: "TS CRUD ok").
- Commands: `cargo run --bin postgres_smoke`, `/Users/andy/tactix/.venv/bin/python verification/postgres_smoke.py`, `npm run pg:smoke`.
- Feature pass count: 120.

Session 2026-01-27 (regression verification – features 016/021/028/031)
- Feature 016 (API auth) UI verified; screenshot: `verification/regression-016-auth-2026-01-27.png`.
- Feature 028 (practice next unseen) UI verified; screenshot: `verification/feature-028-practice-next-unseen-2026-01-27.png`.
- Feature 021 (Chess.com pagination) UI verified; screenshot: `verification/feature-021-chesscom-pagination-2026-01-27.png`.
- Feature 031 (practice attempt grading) verification attempt failed due to missing practice input (queue empty); screenshot: `verification/failed-feature-031-practice-attempt-grading-2026-01-27.png`. Pass flag unchanged.
